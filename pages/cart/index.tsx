import Head from 'next/head'
import { useRecoilValue } from 'recoil'
import NavBar from '../../components/NavBar'
import { ListaDeCompras } from '../../utils/atom'
import { AiOutlineShoppingCart } from 'react-icons/ai'
import Image from 'next/image'
import { FormataBRL } from '../../utils/FormataBRL'
import Footer from '../../components/Footer'


export default function Carrinho() {

  const lista = useRecoilValue(ListaDeCompras)
  const arrPrice = lista.map(item => item.Price * item.Quantity);
  const finalPrice = arrPrice.reduce((a, b) => a + b, 0)
  console.log(lista);
  console.log(finalPrice);

  return (
    <>
      <Head>
        <title>Thrasher</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/icon.webp" />
      </Head>
      <header>
        <NavBar />
      </header>

      <main>
        <section className='m-auto w-[72rem] pt-16 pb-24 ' >
          <div className='flex items-center gap-4 py-4'>
            <AiOutlineShoppingCart className='w-7 h-7' />
            <h1 className='text-2xl uppercase'>Carrinho</h1>
          </div>
          <div className='flex flex-col border-b-2'>
            {lista.map(item => (
              <section key={item.Price} className='flex py-4'>
                <Image src={item.Image} alt='foto do produto' width={200} height={200} className='border-[1px] border-black' />
                <div className='flex flex-col px-4 w-full gap-6'>
                  <div className='flex items-baseline justify-between'>
                    <h3 className='text-2xl'>{item.Name}</h3>
                    <p className='text-xl font-bold'>{FormataBRL(item.Price)}</p>
                  </div>
                  <p className='text-xl text-green-700'>Em estoque</p>
                  <div className='flex gap-6'>
                    <p>Quantidade : {item.Quantity}</p>
                    <p>Tamanho : {item.Size}</p>
                  </div>
                  <div className='space-x-2'>
                    <input type='checkbox' />
                    <label >Este pedido Ã© para presente</label>
                  </div>
                  <button className='text-left'>Excluir</button>
                </div>
              </section>
            ))}
          </div>
          <div className='w-full flex justify-between py-2 px-4 items-center'>
            <button className='text-2xl border-2 p-4 rounded-3xl bg-black text-gray-100'>Fechar pedido</button>
            <h2 className='text-xl'>Subtotal ({lista.length} item): <strong>{FormataBRL(finalPrice)}</strong></h2>
          </div>
        </section>
        <Footer />
      </main>
    </>
  )
}

